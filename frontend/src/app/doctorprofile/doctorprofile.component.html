<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<div style="height: fit-content;min-height:90vh;overflow: hidden;width:100%;">


    <div style="margin: auto;width:400px;height:300px;">
        <div id="details" >
            <img [src]="doctor.image" class="circle-img" width="150">
            <div class="mt-3">
              <h4>{{doctor.name}}</h4>
              <p class="text-secondary mb-1">{{doctor.speciality}}</p>
              <p class="text-secondary mb-1"><i style='font-size:15px; color: red;' class="fa">&#xf0f8;</i> {{doctor.currentHospital}}</p>

              
              <!-- <p class="text-muted font-size-sm"><i style="font-size:15px; color: red;" class="fa">&#xf041;</i> New Jersey</p> -->
              <!-- <button class="btn btn-primary">Follow</button>&#160; -->
              <!-- <button class="btn btn-outline-primary">Message</button> -->
            </div>
    </div>
    </div>
   
    
<div style="width:60%;margin:auto" class="card mt-3" >
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
          <a class="nav-link" [ngClass]="{'active':tab==='visitInfo'}" id="visits-tab" (click)="tab='visitInfo'">Visits Update</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [ngClass]="{'active':tab==='setSchedule'}" id="set-schedule-tab" (click)="tab='setSchedule'">Set Schedule</a>
        </li>
        
      </ul>

</div>
<div style="width:60%;margin:auto;background-color:none" class="col-md-8">
  <div  class="tab-content profile-tab">

    <!-- TAB1 -->

    <div  class="tab-pane fade" [ngClass]="{'show active':tab==='visitInfo'}">

      <div id="upcoming-visits">
        <div class="tab-accordian">

          <mat-accordion>
            <mat-expansion-panel #visitsOfToday>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  Visits Today
                </mat-panel-title>
                <mat-panel-description>
                 View visits today
                </mat-panel-description>
              </mat-expansion-panel-header>

              <span *ngIf='!visitsToday' style="text-align: center;width:100%;color:gray">No Visits Today</span>
              <table>
                <tr *ngFor="let visit of visitsToday">
                  <td>
                    <h5 style="color:royalblue">
      
                      {{visit.user.name}}
      
                    </h5>
                    
                    
                    <div>
                      <small>sex: {{visit.user.sex}} | age: {{visit.user.age}}</small>
                       
      
                    </div>
                     
                  </td>
                  <td>
                    
                    <span>
      
      
                      <div style="display: inline-block;">
                        <h5>
                          <span>
                            <span style="color:royalblue">Appointment:</span>
                            {{twoDigitTime(visit.schedule)}} 
      
                          </span>
                          
                        </h5>
                        
        
                        <div>
        
                      
        
                        </div>
        
                      </div>
                    </span>
                  </td>
                  
                </tr>
              </table>
              
            </mat-expansion-panel>


         
              <mat-expansion-panel #pendingAppointments>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Pending Appointments
                  </mat-panel-title>
                  <mat-panel-description>
                    Confirm/Reject pending appointments
                  </mat-panel-description>
                </mat-expansion-panel-header>
                <table>
                  <tr *ngFor='let schedule of upcomingVisits'>
                    <td>
                      <h5 style="color:royalblue">
        
                        {{schedule.user.name}} 
        
                      </h5>
                      <br>
                      
                      <div>
                        <small>sex: {{schedule.user.sex}}  | age: {{schedule.user.age}} </small>
                         
        
                      </div>
                       
                    </td>
                    <td>
                      
                      <span>
        
        
                        <div style="display: inline-block;">
                          <h5>
                            <span>
                              <span style="color:royalblue">Appointment:</span>
                            {{twoDigitTime(schedule.schedule)}} <h6><em>({{schedule.schedule.toLocaleDateString()}}) </em></h6> 
        
                            </span>
                            
                          </h5>
                          
          
                          <div>
          
                        <small>* {{schedule.count||0}} people on the same slot</small> 
          
                          </div>
          
                        </div>
                      </span>
                    </td>
                    <td>
                      <span>
        
                        <button class='btn-confirm' (click)='confirmAppointment(schedule.id,"confirmed")'>confirm</button>
                        <button class='btn-reject' (click)='confirmAppointment(schedule.id,"rejected")'>reject</button>
        
                      </span>
                     
                    </td>
                  </tr>
                </table>
              </mat-expansion-panel>
  
          </mat-accordion>
  

        </div>
     


      </div>

      

    </div>
    <!-- TAB1 end -->

    <!-- TAB2 -->
    <div  class="tab-pane fade" [ngClass]="{'show active':tab==='setSchedule'}">
      <div class="tab-accordian">
        <mat-accordion >

          <!-- WEEKLY SCHEDULE -->
          <mat-expansion-panel (afterCollapse)='toggleAddBtnState("w",false)' #weeklyExp>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Weekly Schedule
              </mat-panel-title>
              <mat-panel-description>
                View/set weekly schedule
              </mat-panel-description>
            </mat-expansion-panel-header>
            <!-- <div style="background-color:red;height:100px"> </div>-->

              <!-- WEEKLY TABLE -->

              <table id="weekly" >
                
                  <tr *ngFor="let item of days">
                    <td style='width:280px'>{{item.name}}</td>
                    <td>
                      <span *ngIf='!item.schedule.hasOwnProperty("start")' style='color:rgba(182, 177, 177, 0.70);'>no schedule set</span>
                      <!-- <h1 *ngIf='item.day==1'>one</h1> -->
                      <div *ngIf='item.schedule.hasOwnProperty("start")' >
                        <div   class='schedule'>
                        {{item.schedule.start}}-{{item.schedule.end}} <button (click)='removeBtn(item,"weekly")'>&#10060;</button>
                        </div>

                      </div>
                    
                    <!-- <div class="add-slot" (click)='clickfn()'>
                      Add Slot
                      <button>+</button>item.schedule.length!=0
                    </div> -->
                      
                      
                    </td>
                  </tr>

                
                

                

              </table>

              <div>
                <button class="btn-add" (click)='toggleAddBtnState("w",!addBtnState.w)' >&#43; Add</button>


                <form *ngIf="addBtnState.w" action="" [formGroup]='weeklyForm' (ngSubmit)='saveBtn("weekly")'>
                  


                  <div>
                    <select name="" id="day" class="dropdown" formControlName='day'>
                      <option value="" selected disabled hidden>Select Day</option>
                      <option *ngFor="let i of days" value="{{i.day}}">{{i.name}}</option>
                    </select>
                  </div>
                  <div style="display:flex;">
  
                    
                    <div class="picker-input">
    
                      <input  placeholder="Start Time" [ngxTimepicker]="tpickerS11" [format]="24"  formControlName='start' readonly>
                      <ngx-material-timepicker-toggle [for]="tpickerS11"></ngx-material-timepicker-toggle>
                      <ngx-material-timepicker #tpickerS11></ngx-material-timepicker>
    
                    </div>
  
                    <div class="picker-input">
    
                      <input  placeholder="End Time" [ngxTimepicker]="tpickerS12" [min]='weeklyForm.value.start' [format]="24"  formControlName='end' readonly>
                      <ngx-material-timepicker-toggle [for]="tpickerS12"></ngx-material-timepicker-toggle>
                      <ngx-material-timepicker #tpickerS12></ngx-material-timepicker>
    
                    </div>
  
  
  
                    
                  </div>      
  
                  <button type='submit' [disabled]='weeklyForm.invalid' class="btn-save">Save</button>
                  <button class="btn-cancel" (click)='toggleAddBtnState("w",false)'>Cancel</button>


                </form>




              </div>


              <!-- WEEKLY TABLE -->
  
            
          </mat-expansion-panel>
          <!-- WEEKLY SCHEDULE -->

          <!-- MONTHLY SCHEDULE -->
          <mat-expansion-panel (afterCollapse)='toggleAddBtnState("m",false)' #monthlyExp>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Monthly Schedule
              </mat-panel-title>
              <mat-panel-description>
                View/set Monthly Schedule
              </mat-panel-description>
            </mat-expansion-panel-header>
            



            <table id="monthly" >
                
              <tr *ngFor="let item of dates">
                <td style='width:280px'>{{item.date}} <small *ngIf='item.date>28'>*</small>
                </td>
                <td>
                  <!-- <span *ngIf='!item.hasOwnProperty("start")' style='color:rgba(182, 177, 177, 0.70);'>no schedule set</span> -->
                  <!-- <h1 *ngIf='item.day==1'>one</h1> -->
                  <div *ngIf='item.hasOwnProperty("start")' >
                    <div   class='schedule'>
                    {{item.start}}-{{item.end}} <button (click)='removeBtn(item,"monthly")'>&#10060;</button>
                    </div>

                  </div>
                
                <!-- <div class="add-slot" (click)='clickfn()'>
                  Add Slot
                  <button>+</button>item.schedule.length!=0
                </div> -->
                  
                  
                </td>
              </tr>
              <small *ngIf='notOnEveryMonth'>* These dates may not be available in all months</small>

            
            

            

          </table>





            <div>
              <button class="btn-add" (click)='toggleAddBtnState("m",!addBtnState.m)' >&#43; Add</button>

              <form *ngIf="addBtnState.m" action="" [formGroup]='monthlyForm' (ngSubmit)='saveBtn("monthly")'>



              <div>
                <input  class='dropdown' placeholder="Date of month"type="number" formControlName='date' min=1 max=31>

              </div>
              
              <div style="display:flex;">

                
                
                <div class="picker-input">

                  <input  placeholder="Start Time" [ngxTimepicker]="tpickerS21" [format]="24"  formControlName='start' readonly>
                  <ngx-material-timepicker-toggle [for]="tpickerS21"></ngx-material-timepicker-toggle>
                  <ngx-material-timepicker #tpickerS21></ngx-material-timepicker>

                </div>

                <div class="picker-input">

                  <input  placeholder="End Time" [ngxTimepicker]="tpickerS22" [min]='monthlyForm.value.start'[format]="24"  formControlName='end' readonly>
                  <ngx-material-timepicker-toggle [for]="tpickerS22"></ngx-material-timepicker-toggle>
                  <ngx-material-timepicker #tpickerS22></ngx-material-timepicker>

                </div>

                
              </div>      

              <button type="submit"  class="btn-save" [disabled]='monthlyForm.invalid'>Save</button>
                <button class="btn-cancel" (click)='toggleAddBtnState("m",false)'>Cancel</button>



              </form>





            </div>




           
          </mat-expansion-panel >
          <!-- MONTHLY SCHEDULE -->

          <!-- ONETIME -->
          <mat-expansion-panel (afterCollapse)='toggleAddBtnState("o",false)' #onetimeExp >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Special Visits
              </mat-panel-title>
              <mat-panel-description>
                View/set visits out of your regular timings
              </mat-panel-description>
            </mat-expansion-panel-header>
            


            <table id="onetime" >
                
              <tr *ngFor="let item of onetime">
                <td style='width:280px'>{{item.date}} 
                </td>
                <td>
                  <!-- <span *ngIf='!item.hasOwnProperty("start")' style='color:rgba(182, 177, 177, 0.70);'>no schedule set</span> -->
                  <!-- <h1 *ngIf='item.day==1'>one</h1> -->
                  <div *ngIf='item.hasOwnProperty("start")' >
                    <div   class='schedule'>
                    {{item.start}}-{{item.end}} <button (click)='removeBtn(item,"onetime")'>&#10060;</button>
                    </div>

                  </div>
                
                <!-- <div class="add-slot" (click)='clickfn()'>
                  Add Slot
                  <button>+</button>item.schedule.length!=0
                </div> -->
                  
                  
                </td>
              </tr>
              

            
            

            

          </table>


            <div>
              <button class="btn-add" (click)='toggleAddBtnState("o",!addBtnState.o)'>&#43; Add</button>
              <form *ngIf="addBtnState.o" [formGroup]='onetimeForm' action="" (ngSubmit)='saveBtn("onetime")'>

                <div class="picker-input">

                  <input  placeholder="pick a Date" [matDatepicker]="picker"  formControlName='date' readonly>
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
    
                </div>
  
                <div style="display:flex;">
  
                 
  
                  <div class="picker-input">
  
                    <input  placeholder="Start Time" [ngxTimepicker]="tpickerS31" [format]="24"  formControlName='start' readonly>
                    <ngx-material-timepicker-toggle [for]="tpickerS31"></ngx-material-timepicker-toggle>
                    <ngx-material-timepicker #tpickerS31></ngx-material-timepicker>
  
                  </div>
                  
                  <div class="picker-input">
  
                    <input  placeholder="End Time" [min]='onetimeForm.value.start' [ngxTimepicker]="tpickerS32" [format]="24"  formControlName='end' readonly>
                    <ngx-material-timepicker-toggle [for]="tpickerS32"></ngx-material-timepicker-toggle>
                    <ngx-material-timepicker #tpickerS32></ngx-material-timepicker>
  
                  </div>
                  
  
                </div> 
                
                <button type="submit"  class="btn-save" [disabled]='onetimeForm.invalid' >Save</button>
                  <button class="btn-cancel" (click)='toggleAddBtnState("o",false)'>Cancel</button>
                
              </form>

              
            </div>




            
            

          </mat-expansion-panel>
          <!-- ONETIME -->

        </mat-accordion>

      </div>
      
      

    </div>
    <!-- TAB2 end -->

  </div>
  

</div>
</div>

