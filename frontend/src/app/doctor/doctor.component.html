<link rel="stylesheet" href="doctor.component.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<div class="container">

   
    <div class="main-body">
        <div class="row gutters-sm">
            <div class="col-md-4 mb-3">
                <div class="card">
                <div class="card-body">
                    <div class="d-flex flex-column align-items-center text-center">
                    <img [src]='doctor.image' class="round-img">
                    <div class="mt-3">
                      <h4>{{doctor.name}}</h4>
                      <p class="text-secondary mb-1">{{doctor.speciality}}</p>
                      <p class="text-secondary mb-1"><i style='font-size:15px; color: red;' class="fa">&#xf0f8;</i> {{doctor.currentHospital}}</p>
                      
              
                    </div>
                    </div>
                    <div>
                        
                      </div>
                </div>
                </div>
            </div>
        </div>

            <div class="card mt-3">
                <div class="about">
                <div class="profile-head">
                    <div class="d-flex flex-column align-items-center text-center">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link" [ngClass]="{'active':tab==='home'}" id="home-tab" (click)="tab='home'">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" [ngClass]="{'active':tab==='profile'}" id="profile-tab"  (click)="tab='profile'">Ratings and Reviews</a>
                        </li>
                    </ul></div>
                    <div class="col-md-12">
                            <div class="tab-content profile-tab" id="about-tab-content">
                                <div class="tab-pane fade" [ngClass]="{'show active':tab==='home'}" id="about">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>Experience</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <p>{{experienceCalc(doctor.experience)}}</p>
                                                </div>
                                            </div>

                                            
                                            <div *ngIf="rating" class="row">
                                                <div class="col-md-6">
                                                    <label>Rating</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <div style="display:inline-block;color:#0062cc;margin-left:150px;margin-top:10px;margin-bottom:10px;">
                                                        <div style="display:flex;flex-direction:row;margin:2px 0px">
                                                            <h6>{{rating/20}}</h6><small>({{ratingObj.count}})</small>
                                                        </div>
                                                         <ratings  [rating]="rating"></ratings>
                                                         
                                                    </div>
                                                   
                                                </div>
                                            </div>



                                            <div *ngIf="doctor.awards" class="row">
                                                <div class="col-md-6">
                                                    <label>Awards and recognitions</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <p> 2020 Webby Awards for Health & Fitness</p>
                                                </div>
                                            </div>
                                            <div *ngIf="doctor.address" class="row">
                                                <div class="col-md-6">
                                                    <label>Address</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <p>doctor.address</p>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>Email</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <p><a href="#">{{doctor.email}}</a></p>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>Phone</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <p><a >{{doctor.phone}}</a></p>
                                                </div>
                                            </div>
                                            
                                </div>
                            </div>
                            <div class="tab-content" id="review-tab-content">
                                <div class="tab-pane fade"  [ngClass]="{'show active':tab==='profile'}" id="ratings-review" >

                                    <div style="display:flex;flex-direction:row;vertical-align:center">
                                      <h3 *ngIf='user&&user.role=="user"'  style="margin:20px 10%">Your Review</h3>  
                                      <button *ngIf='!editReview&&(user&&user.role=="user")&&(myReview.review||myReview.rating)' class='btn btn-edit' (click)='toggleEdit(true)'><i class="fa fa-edit"></i> Edit</button> 
                                      <button class='btn btn-edit' *ngIf='user&&user.role=="user"' (click)='reportBtn()'>Report Doctor</button>
            
                                    </div>  
                                    <div  *ngIf='reportMsg' style="background-color: rgba(148, 180, 240, 0.651);width:80%;margin: 10px auto;padding:20px;border-radius: 20px;border:1px solid cornflowerblue ;">
                                        <p style="text-align:center; margin:10px auto;">
                                            To report a doctor please send an email to <strong style="color:red;"><em>report@hydoc.in</em></strong>   along with url  to the doctor's and your reasons for reporting  the person.
                                        </p>

                                    </div> 
                                    <div  *ngIf='user&&user.role!="user"' style="margin: 10px auto;padding:20px;height:200px;border-radius: 20px;border:1px solid cornflowerblue ;">
                                        <h4 style="text-align:center; margin:10px auto;color:gray;margin-top:75px;">
                                            Please <strong routerLink='/logout' class='logout'>login</strong> as a Normal User to post a review.
                                        </h4>

                                    </div>

                                    
        
                                  <div  *ngIf='(editReview||!(myReview.review||myReview.rating))&&(user&&user.role=="user")' >

                                                  <div style="margin:10px 10%;">
                                                      <ratings [rating]='myReview.rating*20||0' (ratingOutput)='setRating($event)'  style="margin: 0px 5px;" [mode]="'set'"></ratings>
                                                      <!-- <h6 *ngIf="!(myReview.review||myReview.rating)" style="text-align: center;color:gray;margin-top:20px;"> Type a Review. </h6> -->
                                                      <textarea [value]="myReview.review||''" [(ngModel)]='myTempReview' style="width:100%;height:150px;" name="" id="" ></textarea>
                                                      <div style=" display:flex;flex-direction:row-reverse;">
                                                       

                                                      <button class='btn btn-cancel' (click)='cancelBtn()'>Cancel</button> <button [disabled]="(myReview.review==myTempReview&&(!myReview.rating&&myTempRating==0||myReview.rating==myTempRating))&&(myReview.review=='')" (click)='saveBtn()' class='btn btn-save'>Save</button>

                                                      </div>
                                                  </div>

                                                 

                                                  

                                   </div>

                                  <div *ngIf='!editReview&&(myReview.review||myReview.rating)&&(user&&user.role=="user")'>
                                                  <table>
                                                      <tr>
                                                          <td>
                                                              <div style="margin:20px;height:64px;width:64px;background-color:gray;border-radius: 50%;">
                                                                <img class='pro-img' [src]="userProfile.image||'assets/profile.svg'" style='height:100%;width:100%;overflow:hidden;object-fit:cover;' alt="">
  
                                                              </div>
                                                          </td>
                                                          <td>
                                                              <div>
                                                                  
                                                                  
                                                                <ratings [rating]='myReview.rating*20'></ratings>
                                                                  <small>Updated on:{{dateCreator(myReview.updated)}}</small> 
                                                                  <p style="color:black;margin:0px; font-weight:normal">{{myReview.review}}</p>
                                                                  <h6 *ngIf="myReview.review==''&&myReview.rating" style="text-align: center;color:gray;margin-top:20px;"> Click Edit Button to Add a Review. </h6>
                                                                </div>
  
                                                          </td>
                                                      </tr>
                                                      
                                                  </table>
                                   </div>
                                  
                                   
                                   <h3 style="margin:20px 10%">Other People's Reviews</h3>
                                   
                                          <div id='reviews-list'>
                                            <h4 *ngIf='reviews.length==0' style="text-align: center;color:gray;margin-top:100px;">No other Reviews Yet.</h4>

                                              <table >
                                                  
                                                  <tr *ngFor='let review of reviews'>
                                                      <td>
                                                          <div style="margin:20px;height:64px;width:64px;background-color:gray;border-radius: 50%;">

                                                            <img class='pro-img'  [src]='review.user.image' style='height:100%;width:100%;overflow:hidden;object-fit:cover;' alt="">

                                                          </div>
                                                      </td>
                                                      <td>
                                                          <div>
                                                              <h5>{{review.user.name}}</h5>
                                                              
                                                              <ratings [rating]='review.rating*20'></ratings>

                                                              <small>Updated on: {{dateCreator(review.updated)}}</small>
                                                              <p style="color:black;margin:0px; font-weight:normal">{{review.review}}</p>
                                                          </div>

                                                      </td>
                                                  </tr>

                                                 
                                                  
                                              </table>

                                          </div>

                                              

                                         
                              </div>

                            </div>
                                
                        <button class="button ba-btn" [disabled]='user&&user.role!="user"' (click)='bookAppointment()' >Book Appointment</button>

                    </div>               
                    
                </div>
                </div>         
        </div>
    </div>
</div>